<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>Djinn::Resource</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href='../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>module</span>
          Djinn::Resource
        </h1>
        <ol class='paths'>
          <li>
            <a target="docwin" href="../../files/djinn_restserver_rb.html">djinn_restserver.rb</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong><a target="docwin" href="../Djinn.html">Djinn</a></strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            
            <p>Mixin for resource objects.</p>
            
            <p>Classes that include this module may implement a method
            <code>content_types</code> for content negotiation. This method must return
            a hash of <code>mime-type =&gt; quality</code> pairs. If such a method is
            provided, then the the app will determine the best content type for the
            response body on <code>GET</code> requests, and set this in</p>
            
            <pre>response.header['Content-Type']</pre>
            
            <p>when calling</p>
            
            <pre>do_GET( request, response )</pre>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>Public Class</h3>
            <ol>
              <li><a target="docwin" href="#method-c-new">new</a></li>
            </ol>
            <h3>Public Instance</h3>
            <ol>
              <li><a target="docwin" href="#method-i-do_HEAD">do_HEAD</a></li>
              <li><a target="docwin" href="#method-i-do_OPTIONS">do_OPTIONS</a></li>
              <li><a target="docwin" href="#method-i-empty-3F">empty?</a></li>
              <li><a target="docwin" href="#method-i-globals">globals</a></li>
              <li><a target="docwin" href="#method-i-http_methods">http_methods</a></li>
              <li><a target="docwin" href="#method-i-path">path</a></li>
            </ol>
          </div>
          <div id='context'>
            <div id='includes'>
              <h2>Included modules</h2>
              <ol>
                <li>Rack::Utils</li>
              </ol>
            </div>
          </div>
          <div id='section'>
            <div id='methods'>
              <h2>Public Class methods</h2>
              <div class='method public-class' id='method-method-c-new'>
                <a name='method-c-new'></a>
                <div class='synopsis'>
                  <span class='name'>new</span>
                  <span class='arguments'>(path)</span>
                </div>
                <div class='description'>
                  
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-c-new-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-c-new-source'><span class="ruby-comment"># File djinn_restserver.rb, line 126</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span> <span class="ruby-identifier">path</span>&#x000A;  <span class="ruby-ivar">@djinn_resource_path</span> = <span class="ruby-identifier">path</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-do_HEAD'>
                <a name='method-i-do_HEAD'></a>
                <div class='synopsis'>
                  <span class='name'>do_HEAD</span>
                  <span class='arguments'>(request, response)</span>
                </div>
                <div class='description'>
                  
                  <p>Handles a HEAD request.</p>
                  
                  <p>If a subclass implements method <code>content_types</code>, then the
                  <code>Content-Type</code> header will be set in the response object passed
                  to <code>do_GET</code>.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-do_HEAD-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-do_HEAD-source'><span class="ruby-comment"># File djinn_restserver.rb, line 164</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">do_HEAD</span> <span class="ruby-identifier">request</span>, <span class="ruby-identifier">response</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:do_GET</span>&#x000A;    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">do_GET</span> <span class="ruby-identifier">request</span>, <span class="ruby-identifier">response</span>&#x000A;    <span class="ruby-identifier">response</span>.<span class="ruby-identifier">body</span> = []&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Djinn</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTPStatus</span>, <span class="ruby-string">'405 '</span> <span class="ruby-operator">+</span>  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">http_methods</span>.<span class="ruby-identifier">join</span>( <span class="ruby-string">' '</span> )&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-do_OPTIONS'>
                <a name='method-i-do_OPTIONS'></a>
                <div class='synopsis'>
                  <span class='name'>do_OPTIONS</span>
                  <span class='arguments'>(request, response)</span>
                </div>
                <div class='description'>
                  
                  <p>Handles an OPTIONS request.</p>
                  
                  <p>An <code>Allow:</code> header is created, listing all implemented HTTP
                  methods for this resource.</p>
                  
                  <p>By default, an *HTTP/1.1 204 No Content* is returned (without an entity
                  body). Users may override what’s returned by implementing a method
                  user_OPTIONS which takes two parameters:</p>
                  <ol><li>
                  <p>a Rack::Request object</p>
                  </li><li>
                  <p>a Rack::Response object, to be modified at will.</p>
                  </li></ol>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-do_OPTIONS-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-do_OPTIONS-source'><span class="ruby-comment"># File djinn_restserver.rb, line 185</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">do_OPTIONS</span> <span class="ruby-identifier">request</span>, <span class="ruby-identifier">response</span>&#x000A;  <span class="ruby-identifier">raise</span> <span class="ruby-constant">Djinn</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTPStatus</span>, <span class="ruby-string">'404'</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">empty?</span>&#x000A;  <span class="ruby-identifier">response</span>.<span class="ruby-identifier">status</span> = <span class="ruby-identifier">status_code</span> <span class="ruby-value">:no_content</span>&#x000A;  <span class="ruby-identifier">response</span>.<span class="ruby-identifier">header</span>[<span class="ruby-string">'Allow'</span>] = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">http_methods</span>.<span class="ruby-identifier">join</span> <span class="ruby-string">', '</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-empty-3F'>
                <a name='method-i-empty-3F'></a>
                <div class='synopsis'>
                  <span class='name'>empty?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Flags if the resource <em>exists</em>. For example, a client can
                  <code>PUT</code> to a URL that doesn’t refer to a resource yet. In that
                  case, an <em>empty</em> resource can be provided to handle the
                  <code>PUT</code> request. <code>HEAD</code> and <code>GET</code> requests
                  will still yield a <code>404 Not Found</code>.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-empty-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-empty-3F-source'><span class="ruby-comment"># File djinn_restserver.rb, line 140</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">empty?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-globals'>
                <a name='method-i-globals'></a>
                <div class='synopsis'>
                  <span class='name'>globals</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-globals-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-globals-source'><span class="ruby-comment"># File djinn_restserver.rb, line 130</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">globals</span>&#x000A;  <span class="ruby-constant">Djinn</span><span class="ruby-operator">::</span><span class="ruby-identifier">globals</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-http_methods'>
                <a name='method-i-http_methods'></a>
                <div class='synopsis'>
                  <span class='name'>http_methods</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-http_methods-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-http_methods-source'><span class="ruby-comment"># File djinn_restserver.rb, line 144</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">http_methods</span>&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@restserver_http_methods</span>&#x000A;    <span class="ruby-ivar">@restserver_http_methods</span> = []&#x000A;    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">public_methods</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span>&#x000A;      <span class="ruby-operator">|</span><span class="ruby-identifier">method_name</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-keyword">if</span> ( <span class="ruby-identifier">match</span> = <span class="ruby-regexp">%r\Ado_([A-Z]+)\z/</span>.<span class="ruby-identifier">match</span>( <span class="ruby-identifier">method_name</span> ) )&#x000A;        <span class="ruby-ivar">@restserver_http_methods</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">match</span>[<span class="ruby-value">1</span>]&#x000A;      <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-ivar">@restserver_http_methods</span>.<span class="ruby-identifier">delete</span> <span class="ruby-string">'HEAD'</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@restserver_http_methods</span>.<span class="ruby-identifier">include?</span> <span class="ruby-string">'GET'</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-ivar">@restserver_http_methods</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-path'>
                <a name='method-i-path'></a>
                <div class='synopsis'>
                  <span class='name'>path</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-path-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-path-source'><span class="ruby-comment"># File djinn_restserver.rb, line 124</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">path</span>; <span class="ruby-ivar">@djinn_resource_path</span>; <span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a target="docwin" href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
